= Priority Work Items

Date: 2026-02-15

This file tracks only unfinished, high-impact work.

== P0 (Do Next)

1. Extract shared stream runtime in `replication-core`
- Add common lifecycle/retry/subscription/preflight runtime used by all adapters.
- Goal: reduce copy/paste across `*LogicalReplicationStream` implementations.

2. Introduce shared JDBC polling base
- Migrate first: `replication-oracle`, `replication-db2`, `replication-mariadb`, `replication-cockroachdb`.
- Goal: thin adapter wrappers with shared polling/checkpoint plumbing.

3. Add adapter contract test kit and adopt it
- Validate `start`, `close`, state transitions, subscription cancellation, retry semantics.
- Start with migrated modules from items 1-2.

== In Progress

1. Shared runtime extraction + JDBC base rollout
- Added `AbstractJdbcPollingReplicationStream` in `replication-core`.
- Migrated `replication-oracle` and `replication-db2` logical streams to the shared base.
- Remaining JDBC-family migrations: `replication-mariadb`, `replication-cockroachdb`.

== P1 (Next)

1. Remove `src-legacy-monolith` duplicates after dependency check
- Confirm no build/runtime dependency, then deprecate and remove duplicate classes.

== P2 (Later)

1. Unify options validation/converter patterns across modules.
2. Populate SQL Server commit timestamp when feasible.
3. Add typed startup/preflight exception type carrying report/state.

== Explicitly Not Tracked Here

- Already completed fixes (for example SQL Server tuple checkpoint token and batch paging correctness improvements) are intentionally excluded.

== Completed

1. SQL Server developer ergonomics parity
- Added typed field helpers on `SqlServerChangeEvent` (`rowOrBefore`, `string`, `integer`, `longValue`, `decimal`, `doubleValue`).
- Added sync-handler overload for `startAndSubscribe(...)`.
- Added `SqlServerReplicationAppConfig` and `SqlServerReplicationOptionPresets` with tests.
